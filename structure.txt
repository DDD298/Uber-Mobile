1. CẤU TRÚC MOBILE
1.1. Cấu trúc thư mục chính
Uber-Mobile/
├── app/                          # Thư mục chứa các screen và routing
│   ├── _layout.tsx              # Layout gốc với Clerk authentication
│   ├── index.tsx                # Entry point của ứng dụng
│   ├── +not-found.tsx           # 404 page
│   │
│   ├── (api)/                   # API routes (24 files)
│   │   ├── (stripe)/            # Stripe payment API
│   │   │   └── create+api.ts    # Tạo payment intent
│   │   ├── driver/              # Chứa các API liên quan đến tài xế (8 files)
│   │   │   ├── accept-ride+api.ts # API cho phép tài xế chấp nhận một chuyến xe đang chờ
│   │   │   ├── active-rides+api.ts # API lấy danh sách các chuyến xe đang thực hiện của tài xế
│   │   │   ├── available-rides+api.ts # API tìm kiếm các chuyến xe đang chờ khách trong vùng lân cận
│   │   │   ├── profile+api.ts   # API lấy và cập nhật thông tin hồ sơ của tài xế
│   │   │   ├── register+api.ts  # API xử lý đăng ký thông tin tài xế mới
│   │   │   ├── stats+api.ts     # API cung cấp số liệu thống kê về thu nhập và số chuyến của tài xế
│   │   │   ├── update-location+api.ts # API cập nhật tọa độ GPS thời gian thực của tài xế
│   │   │   └── update-status+api.ts # API cập nhật trạng thái hoạt động (Bật/Tắt chế độ nhận khách)
│   │   ├── driver+api.ts        # API lấy danh sách tài xế
│   │   ├── user+api.ts          # API quản lý user
│   │   ├── notifications/       # API xử lý thông báo đẩy (1 file)
│   │   │   └── register-token+api.ts # Lưu trữ và quản lý Expo Push Token của người dùng
│   │   ├── promo/               # API quản lý mã khuyến mãi (4 files)
│   │   │   ├── active+api.ts    # API lấy danh sách các mã khuyến mãi đang trong thời gian hiệu lực
│   │   │   ├── apply+api.ts     # API thực hiện áp dụng mã giảm giá vào tính toán giá chuyến xe
│   │   │   ├── user-available+api.ts # API lấy các mã khuyến mãi dành riêng cho người dùng hiện tại
│   │   │   └── validate+api.ts  # API kiểm tra điều kiện sử dụng của một mã khuyến mãi cụ thể
│   │   ├── rating/              # API xử lý đánh giá dịch vụ (1 file)
│   │   │   └── create+api.ts    # API lưu trữ đánh giá và nhận xét sau mỗi chuyến đi
│   │   ├── ride/                # API quản lý các giai đoạn của chuyến xe (6 files)
│   │   │   ├── active+api.ts    # API lấy thông tin chi tiết về chuyến xe hiện tại của người dùng
│   │   │   ├── book+api.ts      # API tạo yêu cầu đặt chuyến xe mới
│   │   │   ├── cancel+api.ts    # API xử lý việc người dùng hoặc tài xế hủy chuyến xe
│   │   │   ├── list+api.ts      # API lấy danh sách lịch sử tất cả các chuyến xe đã thực hiện
│   │   │   ├── status-sync+api.ts # API đồng bộ hóa nhanh trạng thái chuyến đi giữa client và server
│   │   │   └── update-status+api.ts # API cập nhật sự thay đổi trạng thái chuyến đi (Đã đón, Hoàn thành...)
│   │   └── upload-image+api.ts  # Upload ảnh lên Cloudinary
│   │
│   ├── (auth)/                  # Authentication screens (4 files)
│   │   ├── _layout.tsx          # Layout cho auth
│   │   ├── sign-in.tsx          # Đăng nhập
│   │   ├── sign-up.tsx          # Đăng ký
│   │   └── welcome.tsx          # Màn hình chào mừng
│   │
│   └── (root)/                  # Main app screens (13 files)
│       ├── _layout.tsx          # Layout chính
│       ├── book-ride.tsx        # Đặt chuyến xe
│       ├── confirm-ride.tsx     # Xác nhận chuyến xe
│       ├── find-ride.tsx        # Tìm chuyến xe
│       ├── driver-registration.tsx # Đăng ký làm driver
│       ├── driver-profile.tsx   # Profile driver
│       ├── promos.tsx           # Danh sách promo codes
│       ├── promo-detail.tsx     # Chi tiết promo code
│       └── tabs/                # Tab navigation (5 files)
│           ├── _layout.tsx      # Tab layout
│           ├── home.tsx         # Trang chủ (có polling 4s cho driver)
│           ├── chat.tsx         # Chat với AI
│           ├── profile.tsx      # Hồ sơ người dùng (có polling 4s)
│           └── rides.tsx        # Lịch sử chuyến xe (có polling 4s)
│
├── components/                   # Reusable components (34 files)
│   ├── Chat/                    # Thành phần giao diện Chat (6 files)
│   │   ├── AIAssistant/
│   │   │   └── index.tsx        # Logic và giao diện trợ lý AI
│   │   ├── ChatBubble/
│   │   │   └── index.tsx        # Bong bóng hiển thị tin nhắn chat
│   │   ├── ChatHeader/
│   │   │   └── index.tsx        # Thanh tiêu đề của cửa sổ chat
│   │   ├── ChatInput/
│   │   │   └── index.tsx        # Ô nhập tin nhắn chat
│   │   ├── ChatInterface/
│   │   │   └── index.tsx        # Giao diện chính kết hợp các thành phần chat
│   │   └── QuickReplies/
│   │       └── index.tsx        # Các nút trả lời nhanh cho người dùng
│   │
│   ├── Common/                  # Các thành phần giao diện dùng chung (11 files)
│   │   ├── CustomButton.tsx     # Nút bấm được style sẵn với nhiều biến thể (Primary, Outline, Danger)
│   │   ├── DriverCard.tsx       # Hiển thị tóm tắt thông tin tài xế, xe và mức đánh giá
│   │   ├── DriverMap.tsx        # Bản đồ chuyên biệt cho tài xế để theo dõi lộ trình đón và trả khách
│   │   ├── GoogleTextInput.tsx  # Thành phần tìm kiếm và gợi ý địa chỉ sử dụng Google Places API
│   │   ├── InputField.tsx       # Ô nhập liệu văn bản có hỗ trợ icon, nhãn và thông báo lỗi
│   │   ├── LanguageSwitcher.tsx # Thành phần cho phép người dùng chuyển đổi giữa tiếng Việt và tiếng Anh
│   │   ├── Map.tsx              # Thành phần bản đồ tích hợp hiển thị vị trí và đường đi cơ bản
│   │   ├── OAuth.tsx            # Thành phần xử lý đăng nhập nhanh qua Google hoặc Apple
│   │   ├── PageHeader.tsx       # Header chuẩn cho các trang con với nút quay lại và tiêu đề
│   │   ├── PassengerMap.tsx     # Bản đồ dành cho hành khách để theo dõi vị trí tài xế đang đến
│   │   └── StarRating.tsx       # Thành phần hiển thị số sao đánh giá và cho phép chọn mức đánh giá
│   │
│   ├── Home/                    # Các thành phần trên màn hình chính (6 files)
│   │   ├── AdditionalServices/
│   │   │   └── index.tsx        # Hiển thị các dịch vụ cộng thêm như thuê xe, cứu hộ
│   │   ├── Features/
│   │   │   └── index.tsx        # Giới thiệu các tính năng mới hoặc nổi bật của ứng dụng
│   │   ├── PolygonLuminary/
│   │   │   └── index.tsx        # Thành phần trang trí nền sử dụng SVG đa giác nghệ thuật
│   │   ├── PromoSection.tsx     # Hiển thị các banner hoặc danh sách khuyến mãi đang chạy
│   │   ├── QuickActions/
│   │   │   └── index.tsx        # Các nút truy cập nhanh vào các tính năng ưu tiên
│   │   └── Stats/
│   │       └── index.tsx        # Hiển thị các số liệu thống kê nhanh trên trang chủ (cho tài xế)
│   │
│   ├── Payment/                 # Các thành phần liên quan đến thanh toán (6 files)
│   │   ├── AvailablePromos/
│   │   │   └── index.tsx        # Danh sách chọn các mã giảm giá có thể áp dụng cho chuyến đi
│   │   ├── CashPaymentModal/
│   │   │   └── index.tsx        # Modal xác nhận và hướng dẫn thanh toán bằng tiền mặt
│   │   ├── PaymentMethodSelection/
│   │   │   └── index.tsx        # Giao diện lựa chọn giữa Ví, Thẻ hoặc Tiền mặt
│   │   ├── PromoCodeInput/
│   │   │   └── index.tsx        # Ô nhập mã khuyến mãi bằng tay để kiểm tra
│   │   ├── QRPaymentModal/
│   │   │   └── index.tsx        # Modal hiển thị mã QR thanh toán để quét bằng app ngân hàng
│   │   └── SuccessModal/
│   │       └── index.tsx        # Thông báo hoàn tất thanh toán và kết thúc chuyến đi thành công
│   │
│   ├── Promo/                   # Thành phần khuyến mãi (1 file)
│   │   └── PromoCard/
│   │       └── index.tsx        # Hiển thị thẻ thông tin mã giảm giá đẹp mắt
│   │
│   └── Ride/                    # Các thành phần liên quan đến chuyến xe (4 files)
│   │       ├── Payment/
│   │       │   └── index.tsx        # Thành phần tích hợp logic thanh toán Stripe vào luồng đặt xe
│   │       ├── RatingModal/
│   │       │   └── index.tsx        # Modal yêu cầu người dùng đánh giá tài xế sau khi xuống xe
│   │       ├── RideCard/
│   │       │   └── index.tsx        # Thẻ hiển thị chi tiết một bản ghi chuyến xe trong lịch sử
│   │       └── RideLayout.tsx       # Layout khung chuẩn cho tất cả màn hình trong quá trình đặt xe
│
├── services/                    # Background services (3 files)
│   ├── pushNotificationService.ts # Push notification service
│   ├── rideStatusPoller.ts      # Service polling trạng thái chuyến đi
│   └── rideStatusUpdater.ts     # Service tự động cập nhật trạng thái
│
├── lib/                         # Utility libraries (14 files)
│   ├── auth.ts                  # Authentication utilities
│   ├── fetch.ts                 # API fetch utilities
│   ├── map.ts                   # Map utilities
│   ├── pricing.ts               # Pricing calculations
│   ├── ride-booking.ts          # Ride booking logic
│   ├── utils.ts                 # General utilities
│   ├── cloudinary.ts            # Cloudinary upload utilities
│   ├── currency.ts              # Currency conversion utilities
│   ├── email/                   # Service quản lý gửi email thông báo (3 files)
│   │   ├── config.ts            # Cấu hình máy chủ SMTP hoặc dịch vụ email (Nodemailer)
│   │   ├── index.ts             # Logic chính xử lý việc tạo và gửi email
│   │   └── templates.ts         # Chứa các mẫu mã nguồn HTML cho email (Hóa đơn, Welcome)
│   └── i18n/                    # Cấu hình hệ thống đa ngôn ngữ (3 files)
│       ├── index.ts             # Khởi tạo i18next và quản lý ngôn ngữ toàn cục
│       └── locales/              # Thư mục chứa các tệp ngôn ngữ
│           ├── en.json          # Các chuỗi văn bản tiếng Anh
│           └── vi.json          # Các chuỗi văn bản tiếng Việt
│
├── store/                       # State management (3 files)
│   ├── index.ts                 # Zustand stores (location, driver)
│   ├── driverStore.ts           # Driver-specific store
│   └── promoStore.ts            # Promo code store
│
├── hooks/                       # Chứa các React Hooks tùy chỉnh (1 file)
│   └── useRideStatusSync.ts     # Hook tự động đồng bộ trạng thái chuyến đi với hệ thống qua polling
│
├── constants/                   # App constants (1 file)
│   └── index.ts                 # Constants và data
│
├── types/                       # TypeScript types (2 files)
│   ├── image.d.ts               # Image type definitions
│   └── type.d.ts                # Main type definitions
│
├── assets/                      # Các tài nguyên tĩnh sử dụng trong ứng dụng (63 files)
│   ├── fonts/                   # Phông chữ Plus Jakarta Sans với đầy đủ các độ dày (14 files)
│   │   ├── PlusJakartaSans-Bold.ttf
│   │   ├── PlusJakartaSans-BoldItalic.ttf
│   │   ├── PlusJakartaSans-ExtraBold.ttf
│   │   ├── PlusJakartaSans-ExtraBoldItalic.ttf
│   │   ├── PlusJakartaSans-ExtraLight.ttf
│   │   ├── PlusJakartaSans-ExtraLightItalic.ttf
│   │   ├── PlusJakartaSans-Italic.ttf
│   │   ├── PlusJakartaSans-Light.ttf
│   │   ├── PlusJakartaSans-LightItalic.ttf
│   │   ├── PlusJakartaSans-Medium.ttf
│   │   ├── PlusJakartaSans-MediumItalic.ttf
│   │   ├── PlusJakartaSans-Regular.ttf
│   │   ├── PlusJakartaSans-SemiBold.ttf
│   │   └── PlusJakartaSans-SemiBoldItalic.ttf
│   ├── icons/                   # Các biểu tượng giao diện dạng icon (29 files)
│   │   ├── aichat.jpg
│   │   ├── arrow-down.png
│   │   ├── arrow-up.png
│   │   ├── back-arrow.png
│   │   ├── chat.png
│   │   ├── check.png
│   │   ├── close.png
│   │   ├── dollar.png
│   │   ├── email.png
│   │   ├── eyecross.png
│   │   ├── google.png
│   │   ├── home.png
│   │   ├── list.png
│   │   ├── lock.png
│   │   ├── map.png
│   │   ├── marker.png
│   │   ├── marker2.png
│   │   ├── out.png
│   │   ├── person.png
│   │   ├── pin.png
│   │   ├── point.png
│   │   ├── profile.png
│   │   ├── search.png
│   │   ├── selected-marker.png
│   │   ├── selected-marker2.png
│   │   ├── star.png
│   │   ├── target.png
│   │   ├── to.png
│   │   └── userchat.jpg
│   └── images/                  # Các hình ảnh minh họa và nền (20 files)
│       ├── adaptive-icon.png
│       ├── car.png
│       ├── check.png
│       ├── favicon.png
│       ├── get-started.png
│       ├── history.png
│       ├── icon.png
│       ├── message.png
│       ├── no-result.png
│       ├── onboarding1.png
│       ├── onboarding2.png
│       ├── onboarding3.png
│       ├── partial-react-logo.png
│       ├── polygon-luminary.svg
│       ├── react-logo.png
│       ├── react-logo@2x.png
│       ├── react-logo@3x.png
│       ├── rent-car.png
│       ├── signup-car.png
│       └── splash.png
│
└── config files                 # Configuration files
    ├── package.json             # Dependencies
    ├── app.json                 # Expo configuration
    ├── tailwind.config.js       # Tailwind CSS config
    ├── tsconfig.json            # TypeScript config
    ├── babel.config.js          # Babel configuration
    ├── metro.config.js          # Metro bundler config
    ├── eslint.config.js         # ESLint configuration
    ├── global.css               # Global CSS styles
    └── .env                     # Environment variables
